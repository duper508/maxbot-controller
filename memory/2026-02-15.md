# 2026-02-15 - MaxBot Controller Deployment Progress

## Project Completion Summary
**MaxBot Controller** - Fallout Pip-Boy styled command center for ClawdBot
- Location: `/home/duper/clawd/clawdbot-controller`
- GitHub: `github.com/duper508/maxbot-controller` (public)
- Tech: Expo + Next.js monorepo, GitHub OAuth, Discord integration

## Session Work Completed

### Code & Infrastructure âœ…
- âœ… GitHub repo created and code pushed (clean history, no secrets)
- âœ… vercel.json configured for monorepo deployment
- âœ… `.env.import` template created with all 8 environment variables
- âœ… `.gitignore` updated to exclude `.env.import` (local secrets only)
- âœ… NEXTAUTH_SECRET generated: `I16zoWMI+P/ZYT1cfXzSUgk34zw9Tt2u3xIt4R9fFT8=`

### GitHub OAuth Setup âœ…
- âœ… OAuth App created: ID `Ov23liy0cOjWTjY6zqg8`
- âœ… GitHub PAT created with `public_repo` scope (read-only, for collaborator checks)
- Note: First created wrong type (GitHub App instead of OAuth App), corrected it

### Discord Integration âœ…
- âœ… Webhook created in #bot-controller-center
- âœ… Bot token collected

### Current Blocker ðŸ”´
**Vercel Deployment 404 Error**
- User deployed to Vercel, getting 404 error
- Root causes identified:
  1. Vercel Root Directory likely set to `apps/web` instead of `./`
  2. May be missing environment variables
  3. Build logs need to be checked

## `.env.import` Status (Local Only)
All 8 variables collected and stored locally (NEVER committed to GitHub):
1. GITHUB_ID: `Ov23liy0cOjWTjY6zqg8`
2. GITHUB_SECRET: (stored locally)
3. GITHUB_PAT: (stored locally, read-only scope)
4. NEXTAUTH_SECRET: `I16zoWMI+P/ZYT1cfXzSUgk34zw9Tt2u3xIt4R9fFT8=`
5. DISCORD_CHANNEL_ID: `1472555271166623775`
6. DISCORD_WEBHOOK_URL: (stored locally)
7. DISCORD_BOT_TOKEN: (user added)
8. NEXTAUTH_URL: (pending - will get from Vercel after 404 fixed)

## Key Decisions Made
- Named app **MaxBot-Controller** instead of ClawdBot for privacy
- GitHub OAuth chosen for authentication (vs Discord OAuth)
- GITHUB_PAT uses minimal `public_repo` scope (read-only)
- `.env.import` kept local for secret management
- Server-side API proxy pattern for all Discord operations

## Vercel Deployment - CRITICAL FIX FOUND

### The 68ms Build Problem
- Vercel was completing build in 68ms with no output
- Root cause: **missing `"framework": "nextjs"` in vercel.json**
- Without this key, Vercel defaults to static mode and skips the Next.js builder entirely

### Solution Applied âœ…
1. Added `"framework": "nextjs"` to vercel.json
2. Set buildCommand: `npx turbo run build --filter=web`
3. Enabled `output: 'standalone'` in apps/web/next.config.js
4. Committed and pushed

### Next Steps
1. Redeploy on Vercel (without cache)
2. Watch for actual Next.js build output (should take 30-90 seconds)
3. Once deployed: Test login and command execution
4. Verify app is accessible at https://maxbot-controller-54hz-vercel.app

## Key Learnings from Deployment
1. **Monorepo + Vercel quirk:** `buildCommand` and `outputDirectory` in vercel.json are ONLY respected when Vercel knows the framework via `"framework"` key
2. **Without framework key:** Vercel assumes static site, skips build entirely
3. **For Turborepo + Next.js:** Use `--filter=web` to build only the web app
4. **Standalone mode:** Required for Vercel deployments to work properly

## Important Notes
- Do NOT commit `.env.import` to GitHub (it's in .gitignore)
- Secrets are managed locally in `.env.import`
- Monorepo structure requires careful Vercel configuration
- NextAuth is strict about environment variables - missing even one causes issues
- GitHub Apps (Iv23...) vs OAuth Apps (Ov23...) - must be OAuth for NextAuth